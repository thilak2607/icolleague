<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iColleague - Status Formatter</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h1>iColleague</h1>
            </div>
            <div class="nav-menu">
                <a href="{{ url_for('dashboard') }}" class="nav-link">Dashboard</a>
                <a href="{{ url_for('contacts') }}" class="nav-link">Contacts</a>
                <a href="{{ url_for('assistant') }}" class="nav-link">Assistant</a>
                <a href="{{ url_for('status_formatter') }}" class="nav-link active">Status Formatter</a>
                <a href="{{ url_for('logout') }}" class="nav-link">Logout</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="page-header">
            <h2>Daily Status Formatter</h2>
            <p>Transform your rough notes into professional status updates</p>
        </div>

        <div class="formatter-container">
            <div class="input-section">
                <h3>Your Notes</h3>
                <textarea id="roughText" placeholder="Enter your rough daily status notes here...

Example: completed user authentication module resolved critical bugs met with design team discussed project timeline prepared for client demo">completed user authentication module resolved critical bugs met with design team discussed project timeline prepared for client demo</textarea>
                <div class="button-group">
                    <button onclick="formatStatus()" class="btn btn-primary">Format Status</button>
                    <button onclick="clearText()" class="btn btn-secondary">Clear</button>
                    <button onclick="loadExample()" class="btn btn-outline">Load Example</button>
                </div>
            </div>

            <div class="output-section">
                <h3>Formatted Status</h3>
                <div id="formattedOutput" class="formatted-output">
                    <p class="placeholder">Your formatted status will appear here...</p>
                </div>
                <div class="button-group">
                    <button onclick="copyFormatted()" class="btn btn-secondary" id="copyBtn" disabled>Copy to Clipboard</button>
                    <button onclick="downloadStatus()" class="btn btn-outline" id="downloadBtn" disabled>Download</button>
                </div>
            </div>
        </div>

        <div class="examples-section">
            <h3>Example Inputs</h3>
            <div class="example-cards">
                <div class="example-card" onclick="setExample('developed payment gateway integration completed unit testing resolved API issues preparing for UAT tomorrow')">
                    <h4>Development Update</h4>
                    <p>"developed payment gateway integration completed unit testing resolved API issues preparing for UAT tomorrow"</p>
                </div>
                <div class="example-card" onclick="setExample('client meeting in Mumbai discussed new requirements gathered feedback preparing technical proposal next steps include architecture review')">
                    <h4>Client Meeting</h4>
                    <p>"client meeting in Mumbai discussed new requirements gathered feedback preparing technical proposal next steps include architecture review"</p>
                </div>
                <div class="example-card" onclick="setExample('resolved server deployment issues completed data migration verified backup systems reviewed performance logs for optimization')">
                    <h4>Technical Work</h4>
                    <p>"resolved server deployment issues completed data migration verified backup systems reviewed performance logs for optimization"</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        function formatStatus() {
            const roughText = document.getElementById('roughText').value.trim();
            
            if (!roughText) {
                alert('Please enter some text to format');
                return;
            }
            
            const outputDiv = document.getElementById('formattedOutput');
            outputDiv.innerHTML = '<div class="loading">Formatting...</div>';
            
            fetch('/format_status', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'rough_text=' + encodeURIComponent(roughText)
            })
            .then(response => response.json())
            .then(data => {
                outputDiv.innerHTML = `<pre>${data.formatted_status}</pre>`;
                document.getElementById('copyBtn').disabled = false;
                document.getElementById('downloadBtn').disabled = false;
            })
            .catch(error => {
                outputDiv.innerHTML = '<p class="error">Error formatting text</p>';
            });
        }

        function clearText() {
            document.getElementById('roughText').value = '';
            document.getElementById('formattedOutput').innerHTML = '<p class="placeholder">Your formatted status will appear here...</p>';
            document.getElementById('copyBtn').disabled = true;
            document.getElementById('downloadBtn').disabled = true;
        }

        function loadExample() {
            document.getElementById('roughText').value = 'completed the user authentication module resolved critical bugs met with design team discussed project timeline preparing for code review next week';
        }

        function setExample(text) {
            document.getElementById('roughText').value = text;
        }

        function copyFormatted() {
            const formattedText = document.querySelector('#formattedOutput pre').textContent;
            
            navigator.clipboard.writeText(formattedText).then(() => {
                const copyBtn = document.getElementById('copyBtn');
                const originalText = copyBtn.textContent;
                copyBtn.textContent = 'Copied!';
                copyBtn.classList.add('btn-success');
                
                setTimeout(() => {
                    copyBtn.textContent = originalText;
                    copyBtn.classList.remove('btn-success');
                }, 2000);
            }).catch(() => {
                alert('Failed to copy to clipboard');
            });
        }

        function downloadStatus() {
            const formattedText = document.querySelector('#formattedOutput pre').textContent;
            const blob = new Blob([formattedText], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `daily_status_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>